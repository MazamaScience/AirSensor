<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html lang="en">
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Enhance synoptic data from PurpleAir — pas_enhanceData • AirSensor</title>

<!-- favicons -->
<link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png" />
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png" />
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png" />
<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png" />

<!-- jquery -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script>
<!-- Bootstrap -->
<link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.4.0/lumen/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous" />


<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script>

<!-- bootstrap-toc -->
<link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script>

<!-- Font Awesome icons -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous" />

<!-- clipboard.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script>

<!-- headroom.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script>

<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script>




<meta property="og:title" content="Enhance synoptic data from PurpleAir — pas_enhanceData" />
<meta property="og:description" content="Enhance raw synoptic data from PurpleAir to create a generally 
useful dataframe.
Steps include:
1) Replace variable with more consistent, more human readable names.
2) Add spatial metadata for each sensor including:
timezone -- olson timezone
countryCode -- ISO 3166-1 alpha-2
stateCode -- ISO 3166-2 alpha-2
airDistrict -- CARB air districts


3) Convert data types from character to POSIXct and numeric.
4) Add distance and monitorID for the two closest PWFSL monitors
5) Add additional metadata items:
sensorManufacturer = &quot;Purple Air&quot;
targetPollutant = &quot;PM&quot;
technologyType = &quot;consumer-grade&quot;
communityRegion -- (where known)


Filtering by country can speed up the process of enhancement and may be
performed by providing a vector ISO country codes to the countryCodes 
argument. By default, no subsetting is performed.
Setting outsideOnly = TRUE will return only those records marked as 
'outside'." />




<!-- mathjax -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->



  </head>

  <body data-spy="scroll" data-target="#toc">
    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-inverse navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">AirSensor</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">1.0.7</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="../index.html">
    <span class="fas fa fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="../articles/AirSensor_Function_Overview.html">AirSensor Function Overview</a>
    </li>
    <li>
      <a href="../articles/Developer_Style_Guide.html">Developer Style Guide</a>
    </li>
    <li>
      <a href="../articles/articles/Australia_on_fire.html">Australia on Fire</a>
    </li>
    <li>
      <a href="../articles/articles/Custom_QC_Algorithms.html">Custom QC Algorithms</a>
    </li>
    <li>
      <a href="../articles/articles/DataFlowChart.html">Processing PurpleAir Data</a>
    </li>
    <li>
      <a href="../articles/articles/SoH_functions.html">SoH Functions</a>
    </li>
    <li>
      <a href="../articles/articles/Temporal_Aggregation.html">Temporally Aggregated Time Series</a>
    </li>
    <li>
      <a href="../articles/articles/outlier_detection.html">Outlier Detection with the Hampel Filter</a>
    </li>
    <li>
      <a href="../articles/articles/pas_introduction.html">PurpleAir Synoptic Data</a>
    </li>
    <li>
      <a href="../articles/articles/pat_introduction.html">PurpleAir Time Series Data</a>
    </li>
    <li>
      <a href="../articles/articles/purpleair_failure_modes.html">PurpleAir Failure Modes</a>
    </li>
  </ul>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="https://github.com/MazamaScience/AirSensor/">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
      
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header>

<div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Enhance synoptic data from PurpleAir</h1>
    <small class="dont-index">Source: <a href='https://github.com/MazamaScience/AirSensor/blob/master/R/pas_enhanceData.R'><code>R/pas_enhanceData.R</code></a></small>
    <div class="hidden name"><code>pas_enhanceData.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>Enhance raw synoptic data from PurpleAir to create a generally 
useful dataframe.</p>
<p>Steps include:</p>
<p>1) Replace variable with more consistent, more human readable names.</p>
<p>2) Add spatial metadata for each sensor including:</p><ul>
<li><p>timezone -- olson timezone</p></li>
<li><p>countryCode -- ISO 3166-1 alpha-2</p></li>
<li><p>stateCode -- ISO 3166-2 alpha-2</p></li>
<li><p>airDistrict -- CARB air districts</p></li>
</ul>

<p>3) Convert data types from character to <code>POSIXct</code> and <code>numeric</code>.</p>
<p>4) Add distance and monitorID for the two closest PWFSL monitors</p>
<p>5) Add additional metadata items:</p><ul>
<li><p>sensorManufacturer = "Purple Air"</p></li>
<li><p>targetPollutant = "PM"</p></li>
<li><p>technologyType = "consumer-grade"</p></li>
<li><p>communityRegion -- (where known)</p></li>
</ul>

<p>Filtering by country can speed up the process of enhancement and may be
performed by providing a vector ISO country codes to the <code>countryCodes</code> 
argument. By default, no subsetting is performed.</p>
<p>Setting <code>outsideOnly = TRUE</code> will return only those records marked as 
'outside'.</p>
    </div>

    <pre class="usage"><span class='fu'>pas_enhanceData</span><span class='op'>(</span>pas_raw <span class='op'>=</span> <span class='cn'>NULL</span>, countryCodes <span class='op'>=</span> <span class='cn'>NULL</span>, includePWFSL <span class='op'>=</span> <span class='cn'>TRUE</span><span class='op'>)</span></pre>

    <h2 class="hasAnchor" id="arguments"><a class="anchor" href="#arguments"></a>Arguments</h2>
    <table class="ref-arguments">
    <colgroup><col class="name" /><col class="desc" /></colgroup>
    <tr>
      <th>pas_raw</th>
      <td><p>Dataframe returned by <code><a href='pas_downloadParseRawData.html'>pas_downloadParseRawData()</a></code>.</p></td>
    </tr>
    <tr>
      <th>countryCodes</th>
      <td><p>ISO country codes used to subset the data.</p></td>
    </tr>
    <tr>
      <th>includePWFSL</th>
      <td><p>Logical specifying whether to calculate distances from 
PWFSL monitors.</p></td>
    </tr>
    </table>

    <h2 class="hasAnchor" id="value"><a class="anchor" href="#value"></a>Value</h2>

    <p>Enhanced Dataframe of synoptic PurpleAir data.</p>
    <h2 class="hasAnchor" id="note"><a class="anchor" href="#note"></a>Note</h2>

    <p>For data obtained on July 28, 2018 this will result in removal of all 
'B' channels, even those whose parent 'A' channel is marked as 'outside'. 
This is useful if you want a quick, synoptic view of the network, e.g. for a 
map.</p>
    <h2 class="hasAnchor" id="see-also"><a class="anchor" href="#see-also"></a>See also</h2>

    <div class='dont-index'><p><a href='pas_downloadParseRawData.html'>pas_downloadParseRawData</a></p></div>

    <h2 class="hasAnchor" id="examples"><a class="anchor" href="#examples"></a>Examples</h2>
    <pre class="examples"><div class='input'><span class='co'># \donttest{</span>
<span class='kw'><a href='https://rdrr.io/r/base/library.html'>library</a></span><span class='op'>(</span><span class='va'><a href='https://github.com/MazamaScience/AirSensor'>AirSensor</a></span><span class='op'>)</span>

<span class='fu'><a href='initializeMazamaSpatialUtils.html'>initializeMazamaSpatialUtils</a></span><span class='op'>(</span><span class='op'>)</span>

<span class='va'>pas</span> <span class='op'>&lt;-</span> <span class='fu'>pas_enhanceData</span><span class='op'>(</span><span class='va'>example_pas_raw</span>, <span class='st'>'US'</span><span class='op'>)</span>

<span class='fu'><a href='https://rdrr.io/r/base/sets.html'>setdiff</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/names.html'>names</a></span><span class='op'>(</span><span class='va'>pas</span><span class='op'>)</span>, <span class='fu'><a href='https://rdrr.io/r/base/names.html'>names</a></span><span class='op'>(</span><span class='va'>example_pas_raw</span><span class='op'>)</span><span class='op'>)</span>
</div><div class='output co'>#&gt;  [1] "label"                     "latitude"                 
#&gt;  [3] "longitude"                 "pm25"                     
#&gt;  [5] "lastSeenDate"              "sensorType"               
#&gt;  [7] "flag_hidden"               "temperature"              
#&gt;  [9] "age"                       "parentID"                 
#&gt; [11] "flag_highValue"            "flag_attenuation_hardware"
#&gt; [13] "pm25_current"              "pm25_10min"               
#&gt; [15] "pm25_30min"                "pm25_1hr"                 
#&gt; [17] "pm25_6hr"                  "pm25_1day"                
#&gt; [19] "pm25_1week"                "statsLastModifiedDate"    
#&gt; [21] "statsLastModifiedInterval" "countryCode"              
#&gt; [23] "stateCode"                 "timezone"                 
#&gt; [25] "deviceID"                  "locationID"               
#&gt; [27] "deviceDeploymentID"        "airDistrict"              
#&gt; [29] "pwfsl_closestDistance"     "pwfsl_closestMonitorID"   
#&gt; [31] "sensorManufacturer"        "targetPollutant"          
#&gt; [33] "technologyType"            "communityRegion"          </div><div class='input'><span class='fu'><a href='https://rdrr.io/r/base/sets.html'>setdiff</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/names.html'>names</a></span><span class='op'>(</span><span class='va'>example_pas_raw</span><span class='op'>)</span>, <span class='fu'><a href='https://rdrr.io/r/base/names.html'>names</a></span><span class='op'>(</span><span class='va'>pas</span><span class='op'>)</span><span class='op'>)</span>
</div><div class='output co'>#&gt;  [1] "Label"             "Lat"               "Lon"              
#&gt;  [4] "PM2_5Value"        "LastSeen"          "Type"             
#&gt;  [7] "Hidden"            "temp_f"            "AGE"              
#&gt; [10] "ParentID"          "Flag"              "A_H"              
#&gt; [13] "v"                 "v1"                "v2"               
#&gt; [16] "v3"                "v4"                "v5"               
#&gt; [19] "v6"                "pm"                "lastModified"     
#&gt; [22] "timeSinceModified"</div><div class='input'>
<span class='kw'>if</span> <span class='op'>(</span> <span class='fu'><a href='https://rdrr.io/r/base/interactive.html'>interactive</a></span><span class='op'>(</span><span class='op'>)</span> <span class='op'>)</span> <span class='op'>{</span>
  <span class='fu'><a href='https://rdrr.io/r/utils/View.html'>View</a></span><span class='op'>(</span><span class='va'>pas</span><span class='op'>[</span><span class='fl'>1</span><span class='op'>:</span><span class='fl'>100</span>,<span class='op'>]</span><span class='op'>)</span>
<span class='op'>}</span>
<span class='co'># }</span>
</div></pre>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top">
      <h2 data-toc-skip>Contents</h2>
    </nav>
  </div>
</div>


      <footer>
      <div class="copyright">
  <p>Developed by Jonathan Callahan, Hans Martin, Kayleigh Wilson, Tate Brasel, Helen Miller.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.6.1.</p>
</div>

      </footer>
   </div>

  


  </body>
</html>


