<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>MVCAA Tutorial 4: Exploring Airsensor Data • AirSensor</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../../favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="../../favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../../apple-touch-icon.png">
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../../apple-touch-icon-120x120.png">
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../../apple-touch-icon-76x76.png">
<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../../apple-touch-icon-60x60.png">
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.4.0/lumen/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../../bootstrap-toc.css">
<script src="../../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../../pkgdown.css" rel="stylesheet">
<script src="../../pkgdown.js"></script><meta property="og:title" content="MVCAA Tutorial 4: Exploring Airsensor Data">
<meta property="og:description" content="AirSensor">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    <div class="container template-article">
      <header><div class="navbar navbar-inverse navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../../index.html">AirSensor</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">1.0.9</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../../index.html">
    <span class="fas fa fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../../articles/AirSensor_Function_Overview.html">AirSensor Function Overview</a>
    </li>
    <li>
      <a href="../../articles/Developer_Style_Guide.html">Developer Style Guide</a>
    </li>
    <li>
      <a href="../../articles/articles/Australia_on_fire.html">Australia on Fire</a>
    </li>
    <li>
      <a href="../../articles/articles/Custom_QC_Algorithms.html">Custom QC Algorithms</a>
    </li>
    <li>
      <a href="../../articles/articles/DataFlowChart.html">Processing PurpleAir Data</a>
    </li>
    <li>
      <a href="../../articles/articles/MVCAA_Tutorial_1.html">MVCAA Tutorial 1: Creating PAT Data</a>
    </li>
    <li>
      <a href="../../articles/articles/MVCAA_Tutorial_2.html">MVCAA Tutorial 2: Exploring PAT Data</a>
    </li>
    <li>
      <a href="../../articles/articles/MVCAA_Tutorial_3.html">MVCAA Tutorial 3: Creating Airsensor Data</a>
    </li>
    <li>
      <a href="../../articles/articles/MVCAA_Tutorial_4.html">MVCAA Tutorial 4: Exploring Airsensor Data</a>
    </li>
    <li>
      <a href="../../articles/articles/MVCAA_Tutorial_5.html">MVCAA Tutorial 5: Building a Local Archive</a>
    </li>
    <li>
      <a href="../../articles/articles/MVCAA_Tutorial_6.html">MVCAA Tutorial 6: Methow Vallely Smoke</a>
    </li>
    <li>
      <a href="../../articles/articles/SoH_functions.html">SoH Functions</a>
    </li>
    <li>
      <a href="../../articles/articles/Temporal_Aggregation.html">Temporally Aggregated Time Series</a>
    </li>
    <li>
      <a href="../../articles/articles/outlier_detection.html">Outlier Detection with the Hampel Filter</a>
    </li>
    <li>
      <a href="../../articles/articles/pas_introduction.html">PurpleAir Synoptic Data</a>
    </li>
    <li>
      <a href="../../articles/articles/pat_introduction.html">PurpleAir Time Series Data</a>
    </li>
    <li>
      <a href="../../articles/articles/purpleair_failure_modes.html">PurpleAir Failure Modes</a>
    </li>
  </ul>
</li>
<li>
  <a href="../../news/index.html">Changelog</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/MazamaScience/AirSensor/">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><script src="MVCAA_Tutorial_4_files/header-attrs-2.5/header-attrs.js"></script><link href="MVCAA_Tutorial_4_files/anchor-sections-1.0/anchor-sections.css" rel="stylesheet">
<script src="MVCAA_Tutorial_4_files/anchor-sections-1.0/anchor-sections.js"></script><script src="MVCAA_Tutorial_4_files/htmlwidgets-1.5.3/htmlwidgets.js"></script><script src="MVCAA_Tutorial_4_files/jquery-1.12.4/jquery.min.js"></script><link href="MVCAA_Tutorial_4_files/leaflet-1.3.1/leaflet.css" rel="stylesheet">
<script src="MVCAA_Tutorial_4_files/leaflet-1.3.1/leaflet.js"></script><link href="MVCAA_Tutorial_4_files/leafletfix-1.0.0/leafletfix.css" rel="stylesheet">
<script src="MVCAA_Tutorial_4_files/proj4-2.6.2/proj4.min.js"></script><script src="MVCAA_Tutorial_4_files/Proj4Leaflet-1.0.1/proj4leaflet.js"></script><link href="MVCAA_Tutorial_4_files/rstudio_leaflet-1.3.1/rstudio_leaflet.css" rel="stylesheet">
<script src="MVCAA_Tutorial_4_files/leaflet-binding-2.0.4.1/leaflet.js"></script><script src="MVCAA_Tutorial_4_files/leaflet-providers-1.9.0/leaflet-providers_1.9.0.js"></script><script src="MVCAA_Tutorial_4_files/leaflet-providers-plugin-2.0.4.1/leaflet-providers-plugin.js"></script><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>MVCAA Tutorial 4: Exploring Airsensor Data</h1>
                        <h4 class="author">Mazama Science</h4>
            
            <h4 class="date">2021-03-09</h4>
      
      <small class="dont-index">Source: <a href="https://github.com/MazamaScience/AirSensor/blob/master/vignettes/articles/MVCAA_Tutorial_4.Rmd"><code>vignettes/articles/MVCAA_Tutorial_4.Rmd</code></a></small>
      <div class="hidden name"><code>MVCAA_Tutorial_4.Rmd</code></div>

    </div>

    
    
<div id="introduction" class="section level2">
<h2 class="hasAnchor">
<a href="#introduction" class="anchor"></a>Introduction</h2>
<p>This tutorial demonstrates how to analyze ‘airsensor’ data using functions tailored to that data type, all of which have names beginning with <code>sensor_</code>. In order to run the code in this tutorial you must have followed the instructions in Tutorials 1-3 and created a directory with ‘pas’, ‘pat’, and ‘airsensor’ data files for the Methow Valley. Target audiences include grad students, researchers and any member of the public concerned about air quality and comfortable working with R and RStudio.</p>
<p>Tutorials in this series include:</p>
<ul>
<li><a href="https://mazamascience.github.io/AirSensor/articles/articles/MVCAA_Tutorial_1.html">MVCAA Tutorial 1: Creating PAT Data</a></li>
<li><a href="https://mazamascience.github.io/AirSensor/articles/articles/MVCAA_Tutorial_2.html">MVCAA Tutorial 2: Exploring PAT Data</a></li>
<li><a href="https://mazamascience.github.io/AirSensor/articles/articles/MVCAA_Tutorial_3.html">MVCAA Tutorial 3: Creating Airsensor Data</a></li>
<li><a href="https://mazamascience.github.io/AirSensor/articles/articles/MVCAA_Tutorial_4.html">MVCAA Tutorial 4: Exploring Airsensor Data</a></li>
<li><a href="https://mazamascience.github.io/AirSensor/articles/articles/MVCAA_Tutorial_5.html">MVCAA Tutorial 5: Building a Local Archive</a></li>
<li><a href="https://mazamascience.github.io/AirSensor/articles/articles/MVCAA_Tutorial_6.html">MVCAA Tutorial 6: Methow Vallely Smoke</a></li>
</ul>
</div>
<div id="goal" class="section level2">
<h2 class="hasAnchor">
<a href="#goal" class="anchor"></a>Goal</h2>
<p>Our goal in this tutorial is to explore a variety of <code>sensor_~()</code> functions available in the <strong>AirSensor</strong> package and to explain their most important arguments and the interpretation of output graphics.</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># Methow Valley local data archive</span>

<span class="co"># ----- Setup ------------------------------------------------------------------</span>

<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/MazamaScience/AirSensor">AirSensor</a></span><span class="op">)</span>

<span class="co"># Use the default archiveDir unless it is already defined</span>
<span class="kw">if</span> <span class="op">(</span> <span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/exists.html">exists</a></span><span class="op">(</span><span class="st">"archiveDir"</span><span class="op">)</span> <span class="op">)</span> <span class="op">{</span>
  <span class="va">archiveDir</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/file.path.html">file.path</a></span><span class="op">(</span><span class="st">"~/Data/MVCAA"</span><span class="op">)</span>
<span class="op">}</span>

<span class="co"># Load previously generated airsensor data</span>
<span class="va">airsensorList</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/get.html">get</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/load.html">load</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/file.path.html">file.path</a></span><span class="op">(</span><span class="va">archiveDir</span>,<span class="st">"airsensorList.rda"</span><span class="op">)</span><span class="op">)</span><span class="op">)</span>

<span class="co"># Print site names and associated ids</span>
<span class="fu"><a href="https://rdrr.io/r/base/lapply.html">sapply</a></span><span class="op">(</span><span class="va">airsensorList</span>, <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="op">{</span> <span class="kw"><a href="https://rdrr.io/r/base/function.html">return</a></span><span class="op">(</span><span class="va">x</span><span class="op">$</span><span class="va">meta</span><span class="op">$</span><span class="va">label</span><span class="op">)</span> <span class="op">}</span><span class="op">)</span> </code></pre></div>
<pre><code>##                               ab5dca99422f2c0d_13669 
##               "MV Clean Air Ambassador @ Balky Hill" 
##                               f6c44edd41c941c7_10182 
##             "MV Clean Air Ambassador @ Benson Creek" 
##                               49215ad49d1a87e3_10188 
##              "MV Clean Air Ambassador @ Bush School" 
##                               f736fd3fb21fc4da_13667 
##               "MV Clean Air Ambassador @ Gunn Ranch" 
##                               db5d6b3b79f5830e_39237 
## "MV Clean Air Ambassador @ Liberty Bell High School" 
##                               4f19d256e1787973_10166 
##          "MV Clean Air Ambassador @ Lower Studhorse" 
##                               f592adb5067ad9d3_13675 
##         "MV Clean Air Ambassador @ McFarland Creek " 
##                               4a47b9252e16e558_15077 
##           "MV Clean Air Ambassador @ Methow Estates" 
##                               0cbfeb2ce4c1553c_13661 
##             "MV Clean Air Ambassador @ Pine Forest " 
##                               2e3b5ceea86a885b_10168 
##       "MV Clean Air Ambassador @ Upper Beaver Creek" 
##                               f96deab8c29aa42b_10134 
##         "MV Clean Air Ambassador @ Willowbrook Farm" 
##                               96b108298883ca47_64441 
##              "MV Clean Air Ambassador-Little Cougar"</code></pre>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># Pull out each sensor as a separate 'airsensor' object</span>
<span class="va">Balky_Hill</span> <span class="op">&lt;-</span> <span class="va">airsensorList</span><span class="op">[[</span><span class="st">"ab5dca99422f2c0d_13669"</span><span class="op">]</span><span class="op">]</span>
<span class="va">Bush_School</span> <span class="op">&lt;-</span> <span class="va">airsensorList</span><span class="op">[[</span><span class="st">"49215ad49d1a87e3_10188"</span><span class="op">]</span><span class="op">]</span>
<span class="va">Liberty_School</span> <span class="op">&lt;-</span> <span class="va">airsensorList</span><span class="op">[[</span><span class="st">"db5d6b3b79f5830e_39237"</span><span class="op">]</span><span class="op">]</span>      <span class="co"># good</span>
<span class="va">McFarland_Creek</span> <span class="op">&lt;-</span> <span class="va">airsensorList</span><span class="op">[[</span><span class="st">"f592adb5067ad9d3_13675"</span><span class="op">]</span><span class="op">]</span>
<span class="va">Pine_Forest</span> <span class="op">&lt;-</span> <span class="va">airsensorList</span><span class="op">[[</span><span class="st">"0cbfeb2ce4c1553c_13661"</span><span class="op">]</span><span class="op">]</span>         <span class="co"># great</span>
<span class="va">Willowbrook_Farm</span> <span class="op">&lt;-</span> <span class="va">airsensorList</span><span class="op">[[</span><span class="st">"f96deab8c29aa42b_10134"</span><span class="op">]</span><span class="op">]</span>    <span class="co"># poor</span>
<span class="va">Benson_Creek</span> <span class="op">&lt;-</span> <span class="va">airsensorList</span><span class="op">[[</span><span class="st">"f6c44edd41c941c7_10182"</span><span class="op">]</span><span class="op">]</span>
<span class="va">Gunn_Ranch</span> <span class="op">&lt;-</span> <span class="va">airsensorList</span><span class="op">[[</span><span class="st">"f736fd3fb21fc4da_13667"</span><span class="op">]</span><span class="op">]</span>
<span class="va">Lower_Studhorse</span> <span class="op">&lt;-</span> <span class="va">airsensorList</span><span class="op">[[</span><span class="st">"4f19d256e1787973_10166"</span><span class="op">]</span><span class="op">]</span>
<span class="va">Methow_Estates</span> <span class="op">&lt;-</span> <span class="va">airsensorList</span><span class="op">[[</span><span class="st">"4a47b9252e16e558_15077"</span><span class="op">]</span><span class="op">]</span> 
<span class="va">Beaver_Creek</span> <span class="op">&lt;-</span> <span class="va">airsensorList</span><span class="op">[[</span><span class="st">"2e3b5ceea86a885b_10168"</span><span class="op">]</span><span class="op">]</span>
<span class="va">Little_Cougar</span> <span class="op">&lt;-</span> <span class="va">airsensorList</span><span class="op">[[</span><span class="st">"96b108298883ca47_64441"</span><span class="op">]</span><span class="op">]</span></code></pre></div>
</div>
<div id="sensor_calendarplot" class="section level2">
<h2 class="hasAnchor">
<a href="#sensor_calendarplot" class="anchor"></a>sensor_calendarPlot</h2>
<p>The <a href="https://mazamascience.github.io/AirSensor/reference/pat_monitorComparison.html">sensor_calendarPlot()</a> function plots PM2.5 concentration in a calendar format. This function is prepares data and ultimately calls the <a href="https://bookdown.org/david_carslaw/openair/">openair</a> package <code>calendarPlot()</code> function.</p>
<p>From the final plot in Tutorial 3, it is clear that the sensor labeled “Pine Forest” has the most complete data after hourly aggregation. Let’s look at air quality impacts at “Pine Forest” using the <a href="https://www.epa.gov/wildfire-smoke-course/wildfire-smoke-and-your-patients-health-air-quality-index">US EPA Air Quality Index colors</a><br>
(<code>colors = "aqi"</code>). We expect that the PM2.5 values reported by the sensor will be exaggerated to some extent. Nevertheless, the calendar plot will still show us which days during September 2020 had the worst PM2.5 levels, putting the health of Methow Valley residents at risk.</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># Create a calendar plot for Pine_Forest</span>
<span class="fu"><a href="../../reference/sensor_calendarPlot.html">sensor_calendarPlot</a></span><span class="op">(</span>
  sensor <span class="op">=</span> <span class="va">Pine_Forest</span>,
  colors <span class="op">=</span> <span class="st">"aqi"</span>,
  title <span class="op">=</span> <span class="st">"September 2020 -- Pine Forest"</span>
<span class="op">)</span></code></pre></div>
<p><img src="MVCAA_Tutorial_4_files/figure-html/sensor-calendarPlots-1.png" width="672"></p>
<p>From the calendar plot we see that the September 8-18 were all days of unhealthy smoke levels with September 13-14 being the worst.</p>
</div>
<div id="sensor_polarplot" class="section level2">
<h2 class="hasAnchor">
<a href="#sensor_polarplot" class="anchor"></a>sensor_polarPlot</h2>
<p>The <a href="https://mazamascience.github.io/AirSensor/reference/sensor_polarPlot.html">sensor_polarPlot()</a> function wraps <code><a href="https://davidcarslaw.github.io/openair/reference/polarPlot.html">openair::polarPlot()</a></code> which plots PM2.5 concentration as a function of wind speed and direction. This type of plot can be helpful in determining the source of a pollutant.</p>
<p>If no wind data is specified, (default) <code>windData = NULL</code>, the function uses wind data from the nearest airport station obtained with the <a href="https://www.rdocumentation.org/packages/worldmet/versions/0.9.2/topics/worldmet">worldmet</a> package.</p>
<p>The color scale for some of the statistics is only to provide an indication of overall pattern and should not be interpreted in concentration units (µg/m3). (See the documentation for <code><a href="https://davidcarslaw.github.io/openair/reference/polarPlot.html">openair::polarPlot()</a></code> for details.)</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># Create a polar plot for Liberty School</span>
<span class="va">polar_plot</span> <span class="op">&lt;-</span> <span class="fu"><a href="../../reference/sensor_polarPlot.html">sensor_polarPlot</a></span><span class="op">(</span>
  sensor <span class="op">=</span> <span class="va">Liberty_School</span>
<span class="op">)</span></code></pre></div>
<p><img src="MVCAA_Tutorial_4_files/figure-html/sensor-polarPlot-Liberty_School-1.png" width="672"></p>
<p>The plot shows that there is evidence of increasing PM25 (smoke) concentrations at low wind speeds from all direction with more smoke coming from from the north. You can use a function from the <strong>PWFSLSmoke</strong> package to create a local map where you will see that the Methow Valley runs primarily north-south at Liberty Bell High School.</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu">PWFSLSmoke</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/PWFSLSmoke/man/monitor_leaflet.html">monitor_leaflet</a></span><span class="op">(</span><span class="va">Liberty_School</span><span class="op">)</span></code></pre></div>
<div id="htmlwidget-4a8dcdd0359c137aad64" style="width:672px;height:480px;" class="leaflet html-widget"></div>
<script type="application/json" data-for="htmlwidget-4a8dcdd0359c137aad64">{"x":{"options":{"crs":{"crsClass":"L.CRS.EPSG3857","code":null,"proj4def":null,"projectedBounds":null,"options":{}}},"setView":[[48.442442,-120.169773],12,[]],"calls":[{"method":"addProviderTiles","args":["Esri.WorldTopoMap",null,null,{"errorTileUrl":"","noWrap":false,"detectRetina":false}]},{"method":"addCircleMarkers","args":[48.442442,-120.169773,10,null,null,{"interactive":true,"className":"","stroke":false,"color":"#03F","weight":5,"opacity":0.5,"fill":true,"fillColor":"#7E0023","fillOpacity":0.7},null,null,"siteName: MV Clean Air Ambassador @ Liberty Bell High School<br>monitorID: db5d6b3b79f5830e_39237<br>elevation: NA<br>pm25: 289.3<br>",null,null,{"interactive":false,"permanent":false,"direction":"auto","opacity":1,"offset":[0,0],"textsize":"10px","textOnly":false,"className":"","sticky":true},null]},{"method":"addLegend","args":[{"colors":["#7E0023","#8F3F97","#FF0000","#FF7E00","#FFFF00","#00E400"],"labels":["Hazardous","Very Unhealthy","Unhealthy","USG","Moderate","Good"],"na_color":null,"na_label":"NA","opacity":1,"position":"bottomright","type":"unknown","title":"AQI Level","extra":null,"layerId":null,"className":"info legend","group":null}]}],"limits":{"lat":[48.442442,48.442442],"lng":[-120.169773,-120.169773]}},"evals":[],"jsHooks":[]}</script><p>To see the wind speed/direction conditions that dominate the overall mean, we can use <code>statistic = "weighted_mean"</code>. As we can see from the plot below, wind from N with a speed between 6 and 4 m/s carries the highest PM25 concentration.</p>
<p>This plot might suggest that wildfire smoke that entered the valley moved up and down the valley as part of typical, diurnal valley airflow patterns.</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># Create a polar plot for Pine Forest using the weighted mean</span>
<span class="va">polar_plot</span> <span class="op">&lt;-</span> <span class="fu"><a href="../../reference/sensor_polarPlot.html">sensor_polarPlot</a></span><span class="op">(</span>
  sensor <span class="op">=</span> <span class="va">Pine_Forest</span>,
  statistic <span class="op">=</span> <span class="st">"weighted_mean"</span>
<span class="op">)</span></code></pre></div>
<p><img src="MVCAA_Tutorial_4_files/figure-html/sensor-polarPlot-Liberty_School-wm-1.png" width="672"></p>
</div>
<div id="sensor_pollutionrose" class="section level2">
<h2 class="hasAnchor">
<a href="#sensor_pollutionrose" class="anchor"></a>sensor_pollutionRose</h2>
<p>The <a href="https://mazamascience.github.io/AirSensor/reference/sensor_pollutionRose.html">sensor_pollutionRose()</a> function wraps <code><a href="https://davidcarslaw.github.io/openair/reference/windRose.html">openair::pollutionRose()</a></code> which plots a traditional wind rose plot for wind direction and PM2.5.</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># Create a pollution rose plot for Liberty School using the proportion of the </span>
<span class="co"># frequency of measurements </span>
<span class="va">pollution_rose</span> <span class="op">&lt;-</span> <span class="fu"><a href="../../reference/sensor_pollutionRose.html">sensor_pollutionRose</a></span><span class="op">(</span>
  sensor <span class="op">=</span> <span class="va">Liberty_School</span>
<span class="op">)</span></code></pre></div>
<p><img src="MVCAA_Tutorial_4_files/figure-html/sensor_pollutionRose_1-1.png" width="672"></p>
<p>Highest PM25 concentrations are mostly associated with southerly winds. However the largest proportion of PM25 concentrations is associated with northerly winds. By setting <code>statistic = "prop.mean"</code> , we can see that northerly winds contribute the most to overall concentrations as shown in the plot below.</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># Create a pollution rose plot for Liberty School using the relative contribution </span>
<span class="co"># of the measurements to the mean</span>
<span class="fu"><a href="../../reference/sensor_pollutionRose.html">sensor_pollutionRose</a></span><span class="op">(</span>
  sensor <span class="op">=</span> <span class="va">Liberty_School</span>,
  statistic <span class="op">=</span> <span class="st">"prop.mean"</span>
<span class="op">)</span></code></pre></div>
<p><img src="MVCAA_Tutorial_4_files/figure-html/sensor_pollutionRose_2-1.png" width="672"></p>
<p>More examples and explanations on how to interpret pollution rose plots can be found in <a href="https://bookdown.org/david_carslaw/openair/sec-windRose.html">“Section 5 Wind and Pollution Roses”</a> of The Openair Book.</p>
</div>
<div id="sensor_extractdata" class="section level2">
<h2 class="hasAnchor">
<a href="#sensor_extractdata" class="anchor"></a>sensor_extractData</h2>
<p>The <a href="https://mazamascience.github.io/AirSensor/reference/sensor_extractDataFrame.html">sensor_extractData() and sensor_extractMeta()</a> functions are convenient wrappers for extracting the airsensor <code>meta</code> and <code>data</code> dataframes. These functions are designed to be useful when manipulating data in an R pipeline using <code><a href="../../reference/%&gt;%.html">%&gt;%</a></code>.</p>
<p>In the example below, we will use data manipulation functions from <strong>PWFSLSmoke</strong> and <strong>dplyr</strong> to calculate some daily statistics for Pine Forest.</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># Use MazamaCoreUtils::dateRange() to ensure we get POSIXct times in the local timezone</span>
<span class="va">dateRange</span> <span class="op">&lt;-</span> <span class="fu">MazamaCoreUtils</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/MazamaCoreUtils/man/dateRange.html">dateRange</a></span><span class="op">(</span>
  startdate <span class="op">=</span> <span class="fl">20200906</span>, 
  enddate <span class="op">=</span> <span class="fl">20200920</span>, 
  timezone <span class="op">=</span> <span class="st">"America/Los_Angeles"</span>
<span class="op">)</span>
<span class="co"># Show daily max for Pine Forest  </span>
<span class="va">Pine_Forest</span> <span class="op">%&gt;%</span>
  <span class="fu">PWFSLSmoke</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/PWFSLSmoke/man/monitor_subset.html">monitor_subset</a></span><span class="op">(</span>tlim <span class="op">=</span> <span class="va">dateRange</span><span class="op">)</span> <span class="op">%&gt;%</span>
  <span class="fu">PWFSLSmoke</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/PWFSLSmoke/man/monitor_dailyStatistic.html">monitor_dailyStatistic</a></span><span class="op">(</span>FUN <span class="op">=</span> <span class="va">max</span><span class="op">)</span> <span class="op">%&gt;%</span>
  <span class="fu"><a href="../../reference/sensor_extractDataFrame.html">sensor_extractData</a></span><span class="op">(</span><span class="op">)</span> <span class="op">%&gt;%</span>
  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate_all.html">mutate_if</a></span><span class="op">(</span><span class="va">is.numeric</span>, <span class="va">round</span>, <span class="fl">0</span><span class="op">)</span></code></pre></div>
<pre><code>##      datetime 0cbfeb2ce4c1553c_13661
## 1  2020-09-06                      3
## 2  2020-09-07                    172
## 3  2020-09-08                    159
## 4  2020-09-09                     82
## 5  2020-09-10                     72
## 6  2020-09-11                    149
## 7  2020-09-12                    292
## 8  2020-09-13                    295
## 9  2020-09-14                    273
## 10 2020-09-15                    250
## 11 2020-09-16                     81
## 12 2020-09-17                     76
## 13 2020-09-18                     83
## 14 2020-09-19                     22</code></pre>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># Show daily averages for Pine Forest </span>
<span class="va">Pine_Forest</span> <span class="op">%&gt;%</span>
  <span class="fu">PWFSLSmoke</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/PWFSLSmoke/man/monitor_subset.html">monitor_subset</a></span><span class="op">(</span>tlim <span class="op">=</span> <span class="va">dateRange</span><span class="op">)</span> <span class="op">%&gt;%</span>
  <span class="fu">PWFSLSmoke</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/PWFSLSmoke/man/monitor_dailyStatistic.html">monitor_dailyStatistic</a></span><span class="op">(</span>FUN <span class="op">=</span> <span class="va">mean</span><span class="op">)</span> <span class="op">%&gt;%</span>
  <span class="fu"><a href="../../reference/sensor_extractDataFrame.html">sensor_extractData</a></span><span class="op">(</span><span class="op">)</span> <span class="op">%&gt;%</span>
  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate_all.html">mutate_if</a></span><span class="op">(</span><span class="va">is.numeric</span>, <span class="va">round</span>, <span class="fl">0</span><span class="op">)</span></code></pre></div>
<pre><code>##      datetime 0cbfeb2ce4c1553c_13661
## 1  2020-09-06                      1
## 2  2020-09-07                      8
## 3  2020-09-08                     86
## 4  2020-09-09                     53
## 5  2020-09-10                     53
## 6  2020-09-11                     76
## 7  2020-09-12                    107
## 8  2020-09-13                    219
## 9  2020-09-14                    255
## 10 2020-09-15                    136
## 11 2020-09-16                     65
## 12 2020-09-17                     72
## 13 2020-09-18                     73
## 14 2020-09-19                     11</code></pre>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># Show daily standard deviations for Pine Forest  </span>
<span class="va">Pine_Forest</span> <span class="op">%&gt;%</span>
  <span class="fu">PWFSLSmoke</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/PWFSLSmoke/man/monitor_subset.html">monitor_subset</a></span><span class="op">(</span>tlim <span class="op">=</span> <span class="va">dateRange</span><span class="op">)</span> <span class="op">%&gt;%</span>
  <span class="fu">PWFSLSmoke</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/PWFSLSmoke/man/monitor_dailyStatistic.html">monitor_dailyStatistic</a></span><span class="op">(</span>FUN <span class="op">=</span> <span class="va">sd</span><span class="op">)</span> <span class="op">%&gt;%</span>
  <span class="fu"><a href="../../reference/sensor_extractDataFrame.html">sensor_extractData</a></span><span class="op">(</span><span class="op">)</span> <span class="op">%&gt;%</span>
  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate_all.html">mutate_if</a></span><span class="op">(</span><span class="va">is.numeric</span>, <span class="va">round</span>, <span class="fl">1</span><span class="op">)</span></code></pre></div>
<pre><code>##      datetime 0cbfeb2ce4c1553c_13661
## 1  2020-09-06                    0.7
## 2  2020-09-07                   36.6
## 3  2020-09-08                   35.0
## 4  2020-09-09                   13.4
## 5  2020-09-10                    8.9
## 6  2020-09-11                   39.1
## 7  2020-09-12                   91.2
## 8  2020-09-13                   55.7
## 9  2020-09-14                    7.8
## 10 2020-09-15                   73.0
## 11 2020-09-16                    8.5
## 12 2020-09-17                    2.2
## 13 2020-09-18                   15.3
## 14 2020-09-19                    6.7</code></pre>
</div>
<div id="pwfslsmoke-and-airmonitorplots" class="section level2">
<h2 class="hasAnchor">
<a href="#pwfslsmoke-and-airmonitorplots" class="anchor"></a>PWFSLSmoke and AirMonitorPlots</h2>
<p>All ‘airsensor’ objects are compatible with ‘monitor’ functions from the <a href="http://mazamascience.github.io/PWFSLSmoke/">PWFSLSmoke</a> package as well as functions from the <a href="http://mazamascience.github.io/AirMonitorPlots/">AirMonitorPlots</a> package for generating <strong>ggplot2</strong> graphics.</p>
<p>The following examples are designed to encourage further exploration of those packages.</p>
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/MazamaScience/PWFSLSmoke">PWFSLSmoke</a></span><span class="op">)</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://ggplot2.tidyverse.org">ggplot2</a></span><span class="op">)</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/MazamaScience/AirMonitorPlots">AirMonitorPlots</a></span><span class="op">)</span>

<span class="co"># "publication-ready" time-series plot</span>
<span class="fu">AirMonitorPlots</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/AirMonitorPlots/man/monitor_ggTimeseries.html">monitor_ggTimeseries</a></span><span class="op">(</span><span class="va">Pine_Forest</span><span class="op">)</span></code></pre></div>
<p><img src="MVCAA_Tutorial_4_files/figure-html/monitor_ggTimeseries-1.png" width="672"></p>
<div class="sourceCode" id="cb17"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># Custom plot showing data + daily averages for the entire Valley</span>
<span class="va">airsensorList</span> <span class="op">%&gt;%</span>
  <span class="fu">PWFSLSmoke</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/PWFSLSmoke/man/monitor_combine.html">monitor_combine</a></span><span class="op">(</span><span class="op">)</span> <span class="op">%&gt;%</span>
  <span class="fu">AirMonitorPlots</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/AirMonitorPlots/man/ggplot_pm25Timeseries.html">ggplot_pm25Timeseries</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span> 
  <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">ggtitle</a></span><span class="op">(</span><span class="st">"Methow Valley Smoke -- September, 2020"</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu">AirMonitorPlots</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/AirMonitorPlots/man/geom_pm25Points.html">geom_pm25Points</a></span><span class="op">(</span>shape <span class="op">=</span> <span class="st">"square"</span>, alpha <span class="op">=</span> <span class="fl">.1</span><span class="op">)</span> <span class="op">+</span> 
  <span class="fu">AirMonitorPlots</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/AirMonitorPlots/man/stat_dailyAQCategory.html">stat_dailyAQCategory</a></span><span class="op">(</span>alpha <span class="op">=</span> <span class="fl">.5</span><span class="op">)</span> <span class="op">+</span> 
  <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_continuous.html">scale_y_continuous</a></span><span class="op">(</span>limits <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">300</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu">AirMonitorPlots</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/AirMonitorPlots/man/custom_aqiStackedBar.html">custom_aqiStackedBar</a></span><span class="op">(</span>width <span class="op">=</span> <span class="fl">0.01</span><span class="op">)</span> </code></pre></div>
<p><img src="MVCAA_Tutorial_4_files/figure-html/monitor_ggDailyHourlyBarplot-1.png" width="672"></p>
<p><em>Best of luck assessing air quality in your community!</em></p>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="copyright">
  <p>Developed by Jonathan Callahan, Hans Martin, Kayleigh Wilson, Tate Brasel, Helen Miller.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.6.1.</p>
</div>

      </footer>
</div>

  


  </body>
</html>
